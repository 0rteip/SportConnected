\documentclass[12pt]{report}

\usepackage{alltt, fancyvrb, url}
\usepackage{titlesec}	% Remove Chapther N*
\titleformat{\chapter}[display]
  {\normalfont\bfseries}{}{0pt}{\Huge}

\usepackage{graphicx}
\usepackage[utf8]{inputenc}
\usepackage{float}
\usepackage{hyperref}
\usepackage[table,xcdraw]{xcolor}

% Questo commentalo se vuoi scrivere in inglese.
\usepackage[italian]{babel}

\usepackage[italian]{cleveref}

\usepackage{changepage}
% \usepackage[none]{hyphenat} % Disabilita la divisione delle parole

\usepackage{tabularx}

\usepackage{enumitem}

\usepackage[left=2.5cm, right=2.5cm, top=2.5cm, bottom=3cm]{geometry}

\title{Elaborato per il corso di\\``Basi di Dati''\\[0.3in]
	\large \it Progetto di una base di dati per la gestione di dati di un'applicazione
}

\author{Pietro Ventrucci\\\href{mailto:pietro.ventrucci@studio.unibo.it}{pietro.ventrucci@studio.unibo.it}\\00001031205}
\date{\today}

\begin{document}

\maketitle

\tableofcontents

\chapter{Analisi dei requisiti}

Si vuole creare una basi di dati a supporto dell'applicazione \emph{SportConnected} per gestire le attività
svolte dagli utenti. La base di dati immagazzina quindi informazioni su utenti e relativa attività al fine
di poter fornire una consultazione comoda per visualizzare i progressi del proprio allenamento o degli altri.

\section{Intervista}
Una persona si registra e viene identificata univocamente nel sistema da un codice, anche un nome, cognome, 
data di nascita; opzionalmente una foto profilo, una biografia, città e provincia, peso, altezza. 
Si può anche indicare il tipo di attrezzatura utilizzata (tipologia di bici o marca di scarpe).
Il tipo di sport, la durata dell'attività, il genere, gli anni, il peso e l'altezza possono servire per
calcolare le calorie spese, la potenza o altri dati utili. Un utente può seguire o essere seguito da altri 
utenti (potrebbero essere suggeriti in base ad amicizie comuni). Ogni utente ha un registro delle proprie 
attività. Possono anche essere salvati dei percorsi o dei segmenti, relativi ad attività di altri utenti, 
o proprie attività i quali vengono salvati sotto forma di file .gpx.

Un percorso rappresenta l'intero itinerario dell'attività e può contenere o meno dei segmenti, mentre un 
segmento è una sezione con determinate caratteristiche, quali salita, discesa, tratto difficile, 
acque libere\dots Ogni tratto completato ha un tempo di percorrenza associato. Le attività hanno i 
propri segmenti e le proprie classifiche.

Possono inoltre essere creati segmenti dagli utenti, a condizione che 
il segmento sia presente nel percorso svolto e che non ne siano presenti altri simili, potrà essere 
impostato come pubblico o privato. Possono essere assegnati dei riconoscimenti all' utente in base ai 
tempi raggiunti sui segmenti, titoli come: più veloce di tutti, top 10, record personale\dots

Le attività possono essere caricate, decidendo la visibilità, il titolo, una descrizine, il tipo si sport, 
un percorso, un giorno, distanza totale, dislivello, velocità media, tempo, calorie bruciate, altitudine\dots 
Vengono visualizzati anche i relativi segmenti del percorso. Possono poi essere commentate da altri 
utenti in grado di assegare anche un apprezzamento.

\section{Estrazione dei concetti principali}

\subsection*{Glossario dei termini}
Si estraggono dall'intervista i concetti principali, fornendone una breve descrizione, eventuali sinonimi e
relazioni con altri concetti.

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
        >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
        >{\raggedright\arraybackslash}p{\dimexpr.47\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
        >{\raggedright\arraybackslash}p{\dimexpr.15\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
        >{\raggedright\arraybackslash}p{\dimexpr.18\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 4
        }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE} 
    \textbf{Termine} & \textbf{Descrizione} & \textbf{Sinonimi} & \textbf{Relazioni} \\
    Utente & Persona che si registra all'applicazione. Può caricare le sue attività o salvare percorsi e segmenti fatti da altri utenti. Può interagire con altri utenti. & Persona & Attrezzatura, Attività, Commento, Percorso, Segmento\\ \hline
    Attrezzatura & Materiale utilizzato da un utente per svolgere le proprie attività. & Bici, Scarpe & Utente \\ \hline 
	Attività & L'insieme di tutte le informazioni dell'attività sportiva svolta da un utente. & Sport & Utente, Percorso, Commento, Sport\\ \hline
    Sport & Tipologia di attività effettuata. Contraddistingue gli sport applicabili ad un segmento. & Attività & Attività, Segmento\\ \hline
    Percorso & Intera tratta percorsa in un'attività. & Itinerario & Attività, Segmento, Utente\\ \hline
    Segmento & Sezione del percorso con determinate caratteristiche. Possono essere creati dagli utenti. & Tratto & Percorso, Utente, Riconoscimento \\ \hline
    Riconoscimento & Titolo assegnato ad un utente sul segmento in base al tempo di impiegato. & Titolo & Utente, Segmento\\ \hline
	Commento & Messaggio lasciato da utenti inerente all'attività svolta da altri utenti. & & Utente, Attività \\
    \end{tabularx}
\end{table}

\subsection*{Ristrutturazione dei requisiti}
A seguito dell'analisi dei requisiti e all'estrazione dei concetti principali si procede eliminando omonimie e
riformulando la richiesta in maniera che risulti più chiara e fruibile per la realizzazione della base di dati.

\vspace{12pt}

Per ogni \textbf{utente} vengono salvati un codice, nome, cognome, data di nascita, sesso e opzionalmente una foto profilo,
biografia, città e provincia, peso, altezza, \textbf{attrezzatura} utilizzata. Un utente può seguire o essere seguito 
da altri utenti. Ad ogni utente vengono associate le relative \textbf{attività} e può salvare \textbf{percorsi} o 
\textbf{segmenti} di altri utenti. Le informazioni sull'utente unite a quelle dell'\textbf{attività} potrebbero essere
utilizzare per calcolare calorie bruciate, potenza e altri dati relativi all'allenamento.

L'\textbf{attrezzatura} è indicabile scegliendo tipologia di bici o marca di scarpe. Ogni utente può specificare un nickname,
non può utilizzare più volte lo stesso nickname, e un modello a piacere (inseribile a piacere, non esiste un elenco 
di modelli da cui scegliere).

Le \textbf{attività} devono specificare titolo, visibilità, \textbf{percorso}, giorno, distanza totale,
tempo, velocità media\dots In base allo \textbf{sport} effettuato hanno più o meno dati rilevanti. Le attività rese pubbliche 
possono ricevere \textbf{commenti} e like da altri \textbf{utenti}.

Lo \textbf{sport} relativo ad un'attività o ad un segmento.

Il \textbf{percorso} è rappresentato da una traccia .gpx, una descrizine, un nome e da possibili \textbf{segmenti}.

Un \textbf{segmento} è rappresentato da una traccia .gpx, una determinata caratteristica, un tempo di
percorrenza associato in attività, visibilità pubblica o privata e un nome. Possono essere percorsi più volte durante un singolo
percorso. I segmenti sono relativi al tipo di \textbf{sport} e possono 
essere creati dagli \textbf{utenti} se presenti nel \textbf{percorso} caricato in un attività e non ne sono presenti 
di simili.

Un \textbf{riconoscimento} può essere assegnato ad un \textbf{utente} in base al tempo impiegato su un determinato 
\textbf{segmento}.

I \textbf{commenti} sono riferiti ad un'\textbf{attività} e scritti da un \textbf{utente}, possono ricevere like.

\chapter{Progettazione concettuale}
\section{Schema scheletro}

\begin{figure}[H]
    \includegraphics[width=\textwidth]{scheletro.png}
    \centering
    \caption{\emph{Schema scheletro con le principali entità.}}
    \label{img:schema_scheletro}
\end{figure}

\section{Raffinamenti proposti}

\begin{figure}[H]
    \includegraphics[width=.8\textwidth]{utente.png}
    \centering
    \caption{\emph{Schema raffinamento utente.}}
    \label{img:schema_utente}
\end{figure}

Per un utente, identificato da un codice univoco, è rappresentato il nome, il cognome,
la data di nascita e opzionalmente il percorso ad una foto profilo caricata, una biografia,
la residenza composta da città e provincia, il peso e l'altezza.
La auto-riferenziazione in utente serve per esprimere il concetto di utenti seguiti e che seguono altri utenti.

\begin{figure}[H]
    \includegraphics[width=.8\textwidth]{attrezzatura.png}
    \centering
    \caption{\emph{Schema raffinamento attrezzatura.}}
    \label{img:schema_attrezzatura}
\end{figure}

L'entità attrezzatura identificata da un nickname è univoca per ogni utente e rappresenta una generalizzazione delle due tipologie 
di attrezzatura disponibili: bicicletta e scarpe, viene quindi utilizzata la specializzazione, tramite generalizzazione totale ed
esclusiva in queste due sottoclassi. Devono esistere nel DB delle entità che contengano tutte le tipologie di bici o le marche di
scarpe associabili a bici e scarpe. L'attributo modello viene lasciato ad attrezzatura in quanto sia che si tratti di scarpe che
di bici andrà specificato e sarà inserito a piacere dall'utente.

\begin{figure}[H]
    \includegraphics[width=.8\textwidth]{attivita.png}
    \centering
    \caption{\emph{Schema raffinamento attività.}}
    \label{img:schema_attivita}
\end{figure}

Ogni attività che viene inserita deve essere obbligatoriamente associata anche ad uno sport, 
il quale può avere delle determinate caratteristiche che sono specificate dalle entità figlie di 
attività, rimane inespresso il vincolo per cui gli sport dell'entità sport siano associati 
alle entità figlie di attività. La generalizzazione è parziale ed esclusiva, perchè possano essere aggiunti
facilmente anche altri sport. Viene salvato anche un percorso, il quale è univoco per ogni attività
e contiene o meno dei segmenti. Possono ricevere commenti scritti da utenti ed ogni commento ha un codice
univoco riferito all'attività dato il grande numero di commenti che potrebbero essere scritti
il numero potrebbe crescere troppo ed è preferibile tenerlo basso.

\begin{figure}[H]
    \includegraphics[width=.8\textwidth]{segmento.png}
    \centering
    \caption{\emph{Schema raffinamento segmento.}}
    \label{img:schema_segmento}
\end{figure}

Il segmento è un'entità che contiene tutti i segmenti esistenti, mentre il tempo di percorrenza
del segmento durante l'attività viene registro tramite segmento percorso. 
Ogni segmento ha una caratteristica che si riferisce ad uno sport.
Rimane inespresso il vincolo per il quale i segmenti facenti parte del percorso sono gli stessi
di segmento percorso collegato ad attività.

\begin{figure}[H]
    \includegraphics[width=.8\textwidth]{segm.png}
    \centering
    \caption{\emph{Schema raffinamento percorso e segmento.}}
    \label{img:schema_perc_seg}
\end{figure}

I percorsi e i segmenti hanno entrambi una traccia, un nome e si riferiscono a tratti di strada od 
altro percorsi durante un'attività, per questo motivo vengono generalizzati dall'entità traccia,
con generalizzazione totale ed esclusiva, dove l'attributo traccia rappresenta il percorso in memoria
nel quale viene salvata la traccia .gpx.

\begin{figure}[H]
    \includegraphics[width=.8\textwidth]{riconoscimento.png}
    \centering
    \caption{\emph{Schema raffinamento riconoscimento.}}
    \label{img:schema_riconoscimento}
\end{figure}

I riconoscimenti vengono assegnati agli utenti in base al loro tempo di percorrenza su tale segmento.
Su un dato segmento solo un utente può avere un determinato riconoscimento. Su un segmento un utente
può avere solo un riconoscimento. Un segmento deve avere almeno un riconoscimento che corrisponde
all'utente che ha creato un segmento.


\section{Schema concettuale finale}
Pagina successiva.

\newgeometry{margin=0cm}
    \begin{figure}[p]
        \centering
        \includegraphics[width=\paperwidth]{totale1.png}
        
    \end{figure}
    
    \begin{figure}[p]
        \centering
        \includegraphics[width=\paperwidth]{totale2.png}
    \end{figure}
    
\restoregeometry

\chapter{Progettazione Logica}

\section{Stima dei volumi}
La stima dei volumi è stata effettuata considerando i dati che un sistema del genere potrebbe generare
da un'utenza ridotta e mediamente attivita in un periodo di un anno e una zona ristretta. Se si considerassero 
anche utenti più o meno attivi e una zona più ampia i dati varierebbero drasticamente.

\begin{center}
    \renewcommand{\arraystretch}{1.4}

     % Altezza delle righe
    \begin{tabularx}{\textwidth}{
        >{\raggedright\arraybackslash}p{\dimexpr.5\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
        >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
        >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
        }
        
        
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE} 
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Volume} \\
    Utente & E & 20.000\\ \hline

    % Ogni attività riceve 4 commenti
    Commento & E & 10.400.000\\ \hline
    Scrive & A & 10.400.000 \\ \hline
    Riceve & A & 10.400.000 \\ \hline

    % ... attività per utente (2.5 a settimana)
    Attività & E & 2.600.000\\ \hline
    Ciclismo & E & 1.040.000\\ \hline
    Corsa & E & 910.000\\ \hline
    Nuoto & E & 650.000\\ \hline
    Svolge & A & 2.600.000 \\ \hline
    Effettuazione & A & 2.6000000 \\ \hline
    Itinerario & A & 2.600.000 \\ \hline
    Percorso & E & 2.600.000 \\ \hline

    Segmento percorso & E & 52.000.000 \\ \hline
    Esecuzione & A & 52.000.000 \\ \hline
    Percorrenza & A & 52.000.000 \\ \hline
    Contiene & A & 52.000.000

    \end{tabularx}

    \begin{tabularx}{\textwidth}{
        >{\raggedright\arraybackslash}p{\dimexpr.5\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
        >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
        >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
        }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE} 
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Volume} \\

    Segmento & E & 15.400.000 \\ \hline

    Caratteristica & A & 15.400.000 \\ \hline
    Caratteristica segmento & E & 20 \\ \hline

    Relativo & A & 20 \\ \hline
    Sport & E & 3 \\ \hline
    % 1.2 segmenti per percorso
    
    Traccia & E & 18.000.000 \\ \hline

    % Attrezzatura
    Attrezzatura & E & 26.000 \\ \hline
    Utilizza & A & 26.000 \\ \hline
    Scarpe & E & 14.000 \\ \hline
    Marca scarpe & A & 14.000 \\ \hline
    Marca & E & 200 \\ \hline
    Bicicletta & E & 12.000 \\ \hline
    Tipologia bicicletta & A & 12.000 \\ \hline
    Tipologia & E & 5 \\ \hline
    
    Salvataggio percorso & A & 25.000 \\ \hline
    
    Salvataggio segmento & A & 40.000 \\ \hline
    Utilizza & A & 45.000 \\ \hline
    
    % 3 per segmento
    Riconoscimento utente & E & 55.440.000\\ \hline
    Elogio & A & 55.440.000\\ \hline
    Riconoscimento segmento & A & 55.440.000\\ \hline
    Assegnazione riconoscimento & A & 55.440.000\\ \hline
    Riconoscimento & E & 8 \\ \hline

    Follow & A & 180.000 \\
    \end{tabularx}
\end{center}

\newpage
\section{Descrizione delle operazioni principali e stima della loro frequenza}

Alcune tra le operazioni più rilevanti che possono essere svolte sono riassumibili
nella seguente tabella insieme alla loro frequenza.

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.12\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.68\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Codice} & \textbf{Operazioe} & \textbf{Frequenza} \\
    1 & Registrazione di un nuovo utente & 40/Giorno \\ \hline
    2 & Svolgimento di un'attività di ciclismo & 3.200/Giorno \\ \hline
    3 & Scrittura di un commento & 24.000/Giorno \\ \hline
    4 & Inserimento di una scarpa da parte di un utente & 18/Giorno \\ \hline
    5 & Assegnazione di un riconoscimento ad un utente & 16.000/Giorno\\ \hline
    6 & Visualizzazione di tutte le attivita dei seguiti da un utente, incluso percorso e sport associati & 9.000/Giorno \\ \hline
    7 & Visualizzazione dell'utente col miglior tempo su un dato segmento & 3.500/Giorno\\ \hline
    8 & Visualizzazione di tutte le attività di nuoto svolte in estate & 5/Anno \\ \hline
    9\label{op_8} & Visualizzazione della distanza totale percorsa in un anno da un utente & 2.900/Giorno \\ \hline
    10 & Visualizzazione delle migliori prestazioni per ogni segmento su un dato utente & 2/Mese \\ \hline
    
    \end{tabularx}
\end{table}

\newpage
\section{Tabelle degli accessi e schemi di navigazione}

Si cerca ora di stimare i costi di accesso per le varie operazioni descritte in precedenza.
Dove non dovesse risultare sufficiente la sola tabella degli accessi sarà fornito anche uno schema
di navigazione.
Per il calcolo degli accessi i pesi delle operazioni in scrittura sono considerati doppi
rispetto a quelli in lettura.

\subsection*{01 - Registrazione di un nuovo utente}

La registraione di un utente si riassume al semplice inserimento dei dati necessari all'entità
utente.

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    Utente & E & 1 & S \\

    \rowcolor[HTML]{DFF8FE}
    \multicolumn{4}{c}{
        \textbf{Totale}: 1S $\cdot$ 40 $\rightarrow$ 80 al giorno
    } \\
    \end{tabularx}


\end{table}

\subsection*{03 - Scrittura di un commento}

Un commento deve essere scritto da un utente e riferito ad un'attività.

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    Utente & E & 1 & L \\ \hline
    Scrive & A & 1 & S \\ \hline
    Commento & E & 1 & S \\ \hline
    Riceve & A & 1 & S \\
    
    \rowcolor[HTML]{DFF8FE}
    \multicolumn{4}{c}{
        \textbf{Totale}: (1L + 3S) $\cdot$ 24.000 $\rightarrow$ $168.000$ al giorno
    } \\
    \end{tabularx}
\end{table}

\subsection*{04 - Inserimento di una scarpa da parte di un utente}

L'inserimento di una scarpa richiede la lettura di tutte le marche presenti per permettere
la scelta in fase di aggiunta.

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    Utente & E & 1 & L \\ \hline
    Utilizza & A & 1 & S \\ \hline
    Attrezzatura & E & 1 & S \\ \hline
    Marca scarpe & A & 1 & S \\ \hline
    Marca & E & 200 & L \\
    
    \rowcolor[HTML]{DFF8FE}
    \multicolumn{4}{c}{
        \textbf{Totale}: (201L + 3S) $\cdot$ 18 $\rightarrow$ $3.726$ al giorno
    } \\
    \end{tabularx}
\end{table}

\subsection*{05 - Assegnazione di un riconoscimento ad un utente}

\begin{figure}[H]
    \includegraphics[width=\textwidth]{riconoscimento schema.png}
    \centering
    \caption{\emph{Schema di navigazione per l'assegnazione di un riconoscimento.}}
    \label{img:riconoscimento_schema}
\end{figure}


\begin{table}[H]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    Utente & E & 1 & L \\ \hline
    Elogio & A & 1 & S \\ \hline
    Segmento & E & 1 & L \\ \hline
    Riconoscimento segmento & A & 1 & S \\ \hline
    Riconoscimento & E & 1 & L \\ \hline
    Assegnazione riconoscimento & A & 1 & S \\ \hline
    Riconoscimento utente & E & 1 & S \\
    
    \rowcolor[HTML]{DFF8FE}
    \multicolumn{4}{c}{
        \textbf{Totale}: (3L + 4S) $\cdot$ 16.000 $\rightarrow$ $176.000$ al giorno
    } \\
    \end{tabularx}
\end{table}




\label{op_7}
\subsection*{06 - Visualizzazione di tutte le attività dei seguiti da un utente}

\begin{figure}[H]
    \includegraphics[width=\textwidth]{seguiti.png}
    \centering
    \caption{\emph{Schema di navigazione per le attività dei seguiti.}}
    \label{img:schema_seguiti}
\end{figure}

\newpage
Supponendo che un utente segua in media 5 altri utenti.

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    Follow & A & 5 & L \\ \hline
    Utente & E & 5 & L \\ \hline
    Svolge & A & 5 & L \\ \hline
    Attività & E & 5 & L \\ \hline
    Itinerario & A & 5 & L \\ \hline
    Percorso & E & 5 & L \\ \hline
    Effettuazione & A & 5 & L \\ \hline
    Sport & E & 5 & L \\

    \rowcolor[HTML]{DFF8FE}
    \multicolumn{4}{c}{
        \textbf{Totale}: 40L $\cdot$ 9.000 $\rightarrow$ $360.000$ al giorno
    } \\
    \end{tabularx}
\end{table}


\subsection*{07 - Visualizzazione dell'utente con il miglior tempo su un dato segmento}

Ogni segmento viene percorso mediamente poco più di 3 volte.

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    Percorrenza & A & 3 & L \\ \hline
    Segmento percorso & E & 3 & L \\ \hline
    Esecuzione & A & 3 & L \\ \hline
    Attività & E & 3 & L \\ \hline
    Svolge & A & 3 & L \\ \hline
    Utente & E & 3 & L \\    

    \rowcolor[HTML]{DFF8FE}
    \multicolumn{4}{c}{
        \textbf{Totale}: 6L $\cdot$ 3.500 $\rightarrow$ $21.000$ al giorno
    } \\
    \end{tabularx}
\end{table}



\subsection*{08 - Visualizzazione di tutte le attività di nuoto svolte in estate}

Siccome ogni attività ha associata la data di effettuazione le operazioni da svolgere
si limitano alla lettura di tutte le attività di nuoto e al controllo di quelle
svolte in estate. Se poi si necessita di visualizzare anche i relativi percorsi
sarà necessario un processo simile a quello usato per \hyperref[op_7]{l'operazione 6}.

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    Attività & E & 650.000 & L \\ 

    
    \rowcolor[HTML]{DFF8FE}
    \multicolumn{4}{c}{
        \textbf{Totale}: 650.000L $\cdot$ 5 $\rightarrow$ $3.250.000$ all'anno
    } \\
    \end{tabularx}
\end{table}

Similmente può essere fatto per \hyperref[op_8]{l'operazione 9}, dove è sufficiente leggere tutte le attività
di un singolo utente e fare i calcoli necessari.


\subsection*{10 - Visualizzazione delle migliori prestazioni per ogni segmento dato un utente}

\begin{figure}[H]
    \includegraphics[width=\textwidth]{prestazioni.png}
    \centering
    \caption{\emph{Schema di navigazione per le migliori prestazioni.}}
    \label{img:schema_prestazioni}
\end{figure}

Ogni utente ha in media 130 attività svolte.

\begin{table}[h!]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    
    Svolge & A & 130 & L \\ \hline
    Attività & E & 130 & L \\ \hline
    Esecuzione & A & 2.600 & L \\ \hline
    Segmento percorso & E & 2.600 & L \\ \hline
    Percorrenza & A & 2.600 & L \\ \hline
    Segmento & E & 2.600 & L \\ \hline

    \rowcolor[HTML]{DFF8FE}
    \multicolumn{4}{c}{
        \textbf{Totale}: 10.660L $\cdot$ 2 $\rightarrow$ $21.320$ al mese
    } \\
    \end{tabularx}
\end{table}


\newpage
\section{Analisi delle ridondanze}

\subsection*{02 - Svolgimento di un'attività di ciclismo}

\begin{figure}[H]
    \includegraphics[width=\textwidth]{svolgimento.png}
    \centering
    \caption{\emph{Schema di navigazione per lo svolgimento di un'attività.}}
    \label{img:navigazione}
\end{figure}

\newpage
Ogni percorso contiene circa 20 segmenti.

\begin{table}[H]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    Utente & E & 1 & L \\ \hline
    Svolge & A & 1 & S \\ \hline
    Attività & E & 1 & S \\ \hline
    Itinerario & A & 1 & S \\ \hline
    Percorso & E & 1 & S \\ \hline
    Effettuazione & A & 1 & S \\ \hline
    Contiene & A & 20 & S \\ \hline
    Esecuzione & A & 20 & S \\ \hline
    Segmento Percorso & E & 20 & S \\ \hline
    Percorrenza & A & 20 & S \\
    
    \rowcolor[HTML]{DFF8FE}
    \multicolumn{4}{c}{
        \textbf{Totale}: (1L + 85S) $\cdot$ 3.200 $\rightarrow$ 547.200 al giorno
    } \\
    \end{tabularx}
\end{table}

L'assegnazione ad un percorso dei segmenti corretti richiede l'utilizzo di un algoritmo 
in grado di analizzarli ed ha come conseguenza che i costi di accesso potrebbero variare
in base al numero dei segmenti. 
Ipotizzando una distribuzione non omogenea nei segmenti tra gli sport, in particolare 
considerando per il ciclismo $1/2$ dei segmenti (7.700.000) e una divisione equa per i restanti:

\begin{table}[H]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{faecff}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    Segmento & E & 7.700.000 & L \\ \hline
    Caratteristica & A & 7.700.000 & L \\ \hline
    Caratteristica segmento & E & 7.700.000 & L \\
    
    \rowcolor[HTML]{faecff}
    \multicolumn{4}{c}{
        \textbf{Totale}: 23.100.000L $\cdot$ 3.200 $\rightarrow$ $7.392 \times 10^{10}$ al giorno
    } \\
    \end{tabularx}
\end{table}

Per cercare di ridurre il numero degli accessi si è deciso di inserire una ridondanza in segmento.
Grazie all'attributo Sport si può evitare di passare per \emph{Caratteristica segmento}.

\begin{table}[H]
    \centering
    \renewcommand{\arraystretch}{1.4} % Altezza delle righe
    \begin{tabularx}{\textwidth}{
    >{\raggedright\arraybackslash}p{\dimexpr.35\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 1
    >{\raggedright\arraybackslash}p{\dimexpr.25\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 2
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    >{\raggedright\arraybackslash}p{\dimexpr.2\linewidth-2\tabcolsep-1.3333\arrayrulewidth}% column 3
    }
    \arrayrulecolor[HTML]{BDBFC3}
    \rowcolor[HTML]{DFF8FE}
    \textbf{Concetto} & \textbf{Costrutto} & \textbf{Accessi} & \textbf{Tipo} \\
    Segmento & E & 7.700.000 & L \\ 
    
    \rowcolor[HTML]{DFF8FE}
    \multicolumn{4}{c}{
        \textbf{Totale}: 7.700.000L $\cdot$ 3.200 $\rightarrow$ $2.464 \times 10^{10}$ al giorno
    } \\
    \end{tabularx}
\end{table}


\newpage
\section{Raffinamento dello schema}

\subsection*{Eliminazione delle gerarchie}

Per la gerarchia \emph{Attività} (p, e) si è scelto di adottare il collasso verso l'alto dato che le
entità figlie sono accedute in maniera contestuale a quella padre. Risulta inoltre comodo avere
tutti i parametri relativi ad un'attività in un'entità unica. 

Per la gerarchia \emph{Traccia} (t, e) si é scelto di adottare il collasso verso il basso siccome gli
accessi alle entità figlie sono distinti e non si ha necessità che l'identificatore sia univoco.
Scelta analoga è stata fatta per la gerarchia \emph{Attrezzatura} (t, e), con differenza nella scelta
dell'identificatore.

\subsection*{Eliminazione degli attributi composti}

L'attributo composto \emph{residenza} nell'entità \emph{Utente} é stato scomposto nelle sue 
componenti, sarà poi necessario controllare a livello applicativo che i valori 
vengano inseriti in maniera coerente.

\subsection*{Scelta delle chiavi primarie}

Nello schema sono già evidenziate tutte le chiavi primarie per la maggior
parte delle entità. Per l'entità \emph{Riconoscimento utente} si sceglie di utilizzare come chiave
primaria l'associazione con \emph{Utente} e \emph{Segmento}, lasciando il rimanente vincolo (assegnare
un solo riconoscimento per utente) da implementare a livello applicativo.

\subsection*{Eliminazione degli identificatori esterni}
Nella traduzione da E/R a schema logico sono eliminate le seguenti associazioni:

\begin{itemize}[itemsep=0pt, parsep=1pt]
    \item Tipologia bicicletta, importando IdTipologia in Bicicletta
    \item Marca scarpe, importando IdMarca in Scarpe
    \item Utilizza bicicletta, importando IdUtente in Bicicletta
    \item Utilizza scarpe, importando IdUtente in Scarpe
    \item Assegnazione riconoscimento, importando IdRiconoscimento in Riconoscimento utente
    \item Riconoscimento segmento, importando IdSegmento in Riconoscimento utente
    \item Elogio, importando IdUtente in Riconoscimento utente
    \item Caratteristica, importando IdCaratteristica in Segmento
    \item Relativo, importando IdSport in Caratteristica segmento
    \item Percorrenza, importando IdSegmento in Segmento percorso
    \item Effettuazione, importando IdSport in Attività
    \item Esecuzione, importando IdAttività e IdSport in Segmento percorso
    \item Itinerario, importando IdPercorso in Attività
    \item Riceve, importando IdSport e IdAttività in Commento
    \item Scrive, importando IdUtente in Commento
    \item Svolge, importando IdUtente in Attività
    \item Contiene, retificata importando IdPercorso da Percorso e IdSegmento da Segmento
    \item Salvataggio segmento, retificata importando IdUtente da Utente e IdSegmento da Segmento
    \item Salvataggio percorso, retificata importando IdPercorso da Percorso e IdUtente da Utente
    \item Follow, retificata importando IdUtente da Utente e SegIdUtente da Utente
  \end{itemize}


\section{Traduzione di entità e associazioni in relazioni}



\section{Schema relazionale finale}
Pagina successiva.

\newgeometry{margin=0cm}
    \begin{figure}[p]
        \centering
        \includegraphics[height=\paperheight]{schema_logico_1.png}
        
    \end{figure}
    
    \begin{figure}[p]
        \centering
        \includegraphics[height=\paperheight]{schema_logico_2.png}
    \end{figure}
    
\restoregeometry

\end{document}